<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Test Cookbook</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#9b4dca" />
    <link rel="manifest" href="/manifest.json">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">

    <!-- CSS Reset -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/necolas/normalize.css/master/normalize.css">

    <!-- Milligram CSS minified -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/milligram/milligram/master/dist/milligram.min.css">

    <link rel="stylesheet" href="/css/style.css">
    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-85156207-1', 'auto');
        ga('send', 'pageview');
    </script>

    <script>
        function menutoggle() {
            var x = document.getElementById("sidemenu");
            var y = document.getElementById("content");
            if (x.style.display === 'none') {
                x.style.display = 'block';
                y.className = "column column-75";
            } else {
                x.style.display = 'none';
                y.className = "column column-100";
            }
        }

        function menu() {
            if (window.innerWidth >= 1024) {
                menutoggle();
            }
        }
    </script>
</head>
<body onload="menu()">
<div class="container">
    <div class="row">
        <div class="column column-80">
            <h1><a href="/">Test Cookbook</a></h1>
        </div>
        <div class="column">
            <button onclick="menutoggle()">Menu</button>
        </div>
    </div>
</div>

<hr/>
<div class="container">
    <div class="row">
        <div id="sidemenu" class="sidemenu column" style="display: none;">
            <ol>
    <li class="header">Preface</li>
    <ul>
        <li class="chapter active" data-level="1.1" data-path="./">
            <a href="/">Introduction</a>
        </li>
    </ul>
    <li class="header">Common Automation Concepts</li>
    <ul>
        <li>
            <a href="/book/common-automation-concepts/assumption-styles.html">
                Assumption Styles
            </a>
        </li>
        <li>
            <a href="/book/common-automation-concepts/gherkin.html">
                Gherkin
            </a>
        </li>
        <li>
            <a href="/book/common-automation-concepts/json-schema.html">
                JSON-Schema
            </a>
        </li>

    </ul>
    <li>Bash</li>
    <ul>
        <li>
            <a href="/book/bash/Bash.html">
                Bash
            </a>
        </li>
        <li>
            <a href="/book/bash/shpec-testing.html">
                SHPEC Testing
            </a>
        </li>
        <li>
            <a href="/book/bash/shpec-and-curl.html">
                SHPEC and Curl
            </a>
        </li>
    </ul>


    <li>C</li>
    <ul>
        <li>
            <a href="/book/c/unit-test-with-cmocka.html">
                Unit Test with CMOCKA
            </a>
        </li>
    </ul>

    <li>C++</li>
    <ul>
        <li>
            <a href="/book/cpp/setting-up-cmake-google-test.html">
                Setting up CMake for Google Test
            </a>
        </li>
        <li>
            <a href="/book/cpp/unit-test-with-google-test.html">
                Unit Test with Google Test
            </a>
        </li>
    </ul>

    <li>Clojure</li>
    <ul>
        <li>
            <a href="/book/clojure/unit-test-with-clojure.html">
                Unit Test with Clojure
            </a>
        </li>
    </ul>

    <li>Go</li>
    <ul>
        <li>
            <a href="/book/go/test-with-go.html">
                Test with Go
            </a>
        </li>
    </ul>
    <li>Java</li>
    <ul>
        <li>
            <a href="/book/java/intro-to-gradle.html">
                Intro to Gradle
            </a>
        </li>
        <li>
            <a href="/book/java/intro-to-maven.html">
                Intro to Maven
            </a>
        </li>
        <li>
            <a href="/book/java/junit.html">JUnit</a>
        </li>
        <li>
            <a href="/book/java/junit/cucumber-and-selenium.html">Cucumber & Selenium</a>
        </li>
    </ul>
    <li>Javascript</li>
    <ul>
        <li>
            <a href="/book/javascript/first-nodejs-project.html">First NodeJS Project</a>
        </li>
        <li>
            <a href="/book/javascript/jasmine.html">Jasmine</a>
            <ul>
                <li>
                    <a href="/book/javascript/jasmine/jasmine-within-a-browser.html">
                        Jasmine within a Browser
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <a href="/book/javascript/cucumber-js.html">
                Cucumber JS
            </a>
            <ul>
                <li>
                    <a href="/book/javascript/cucumber-js/cucumber-+-chai.html">
                        Cucumber + Chai
                    </a>
                </li>

                <li>
                    <a href="/book/javascript/cucumber-js/cucumberjs-+-selenium.html">
                        CucumberJS + Selenium
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <a href="/book/javascript/frisbyjs.html">
                FrisbyJS
            </a>
        </li>
        <li>
            <a href="/book/javascript/galen-framework.html">
                Galen Framework
            </a>
        </li>
        <li>
            <a href="/book/javascript/json-schema/tiny-validator.html">
                Tiny Validator v4
            </a>
        </li>

    </ul>
    <li>PHP</li>
    <ul>
        <li>
            <a href="/book/php/phpunit.html">
                PHPUnit
            </a>
        </li>
        <li>
            <a href="/book/php/phpunit/phpunit-+-selenium.html">
                PHPUnit + Selenium
            </a>
        </li>

    </ul>


    <li>Python</li>
    <ul>
        <li>
            <a href="/book/python/lettuce.html">
                Lettuce
            </a>
        </li>
        <li>
            <a href="/book/python/lettuce/lettuce-+-selenium.html">
                Lettuce + Selenium
            </a>
        </li>
        </li>
        <li>
            <a href="/book/python/robot-framework.html">
                Robot Framework
            </a>
        </li>
        <li>
            <a href="/book/python/json-schema-validation.html">
                JSON Schema Validation
            </a>
        </li>
    </ul>

    <li>Ruby</li>
    <ul>
        <li>
            <a href="/book/ruby/rspec.html">RSpec Unit Tests</a>
        </li>
        <li>
            <a href="/book/ruby/cucumber-+-ruby.html">Cucumber + Ruby</a>
        </li>
    </ul>
    <li>Rust</li>
    <ul>
        <li>
            <a href="/book/rust/unit-test-rust.html">Rust Unit Tests</a>
        </li>
    </ul>
</ol>

        </div>
        <div id="content" class="column column-100">
            <h1 id="cucumberjs--selenium-web-driver">CucumberJS + Selenium Web Driver</h1>

<h2 id="create-a-cucumberjs-project">Create a CucumberJS project</h2>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># install Cucumber and Selenium webdriver</span>
<span class="gp">$ </span>npm install cucumber selenium-webdriver

<span class="c"># install browser drivers</span>
<span class="gp">$ </span>npm install chromedriver geckodriver

<span class="c"># install an assertion tool</span>
<span class="gp">$ </span>npm install assert
</code></pre>
</div>

<p>If you are using a package.json file you will probably want to save all of these modules to dev dependencies.  to do that when running npm install add a switch –save-dev to the command.</p>

<blockquote>
  <p>Another nice thing to do with a package.json file is to add test script.</p>
</blockquote>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"test"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./node_modules/.bin/cucumber-js"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>With this added to your NPM package file you can run all your cucumber tests by typing in “npm test” on the command line.</p>

<hr />

<h2 id="folder-structure">Folder Structure</h2>

<p>First off we need to create a place for all of our feature files written in<br />
Gherkin.  Within this folder you will create files with an extension of feature.<br />
For example “testFile.feature”.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>mkdir features
</code></pre>
</div>

<p>After creating the features directory we need a place to store our code that runs the features and does the assertions.  We call these step definitions.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">cd </span>features
mkdir step_definitions
</code></pre>
</div>

<p>Last but not least we need to create a support directory that handles initializing the World object for Cucumber and other enhancements for Cucumber.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>mkdir support
</code></pre>
</div>

<p>Once done you should have a folder stucture like this.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- features
  - step_definitions
  - support
</code></pre>
</div>

<hr />

<h2 id="create-the-cucumber-world">Create the Cucumber World.</h2>

<p>Within the support directory create a file named “world.js”.  In this file we can require some libraries, select browser to test with and set some timeouts.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">seleniumWebdriver</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'selenium-webdriver'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">CustomWorld</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">driver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">seleniumWebdriver</span><span class="p">.</span><span class="nx">Builder</span><span class="p">()</span>
                  <span class="p">.</span><span class="nx">forBrowser</span><span class="p">(</span><span class="s1">'firefox'</span><span class="p">)</span>
                  <span class="p">.</span><span class="nx">build</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">World</span> <span class="o">=</span> <span class="nx">CustomWorld</span><span class="p">;</span>

  <span class="c1">// sets a default timeout to 30 seconds.  Time is in ms.</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setDefaultTimeout</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<hr />

<h2 id="describe-your-behavior">Describe your behavior.</h2>

<p>Create a feature file like “test_cookbook.feature”.  Within the file describe<br />
the behavior that you would like.</p>

<pre><code class="language-Gherkin">Feature: Test Cookbook Home Page

  Scenario: Test Cookbook Title Description
    Given I visit Test Cookbook website
    Then I see title Test Cookbook
</code></pre>

<hr />

<h2 id="define-your-step">Define your step.</h2>

<p>Create a file called “test_cookbook.js” and we can start building our step definitions.</p>

<p>Within the file we first need to setup a javascript module.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>
</code></pre>
</div>

<p>When you run the tests Cucumber will be looking for regular expression  matching<br />
functions to execute. In the feature file the first step we have is a Given<br />
statement.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Now that we have an expression to run, we also need to give it some direction. Lets have it take us to “www.testcookbook.com”.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>If you were to run the tests at this point you should see a browser pop up and goto “www.testcookbook.com”.</p>

<blockquote>
  <p>At this point you may still see a browser on the screen.  While starting out its not a big deal to close the window by hand.  However we can add a hooks.js file within the step_definitions folder to handle that for us.</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>We now have some code in place to take us to a website.  But thats not really testing anything.  If we look back at the feature file we have a validation step that says the title of the page should be “Test Cookbook”.  To accomplish this we need to get the text for the title and assert whether or not it equals the desired outcome.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">Then</span><span class="p">(</span><span class="sr">/^I see title Test Cookbook$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="s2">"Test Cookbook"</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">title</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Now give it a run.</p>

<p>UH OH!!  It didn’t work like expected did it? You probably see something that says “ReferenceError: assert is not defined”. CucumberJS needs an extra library in order to assert or expect specific values.  Luckily this is an easy fix. Provided that you installed the assert package at the beginning all we need to do is require assert.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'assert'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">Then</span><span class="p">(</span><span class="sr">/^I see title Test Cookbook$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="s2">"Test Cookbook"</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">title</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>If you run npm test this time you should be able to get some passing tests.</p>

<p>Please note if you are working with Firefox that newer versions will require geckodriver.  If you see firefox open up and never does anything you are more than likely missing that module.</p>

<p>Would you like to pull down a working project?  Look on GitHub.<br />
<a href="https://github.com/testcookbook/js-cucumber-selenium">https://github.com/testcookbook/js-cucumber-selenium</a></p>


        </div>
    </div>
</div>
</body>
</html>
