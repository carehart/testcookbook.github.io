<!DOCTYPE html>
<html>
  <head>
    <title>Validating JSON with Python</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="content-language" content="en-us">
    <meta name="description" content="Simple how to validate JSON format with Python">
    <link rel="stylesheet" href="/lib/w3.css" />
    <link rel="stylesheet" href="/lib/style.css" />
    <link rel="stylesheet" href="/lib/zenburn.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85156207-1', 'auto');
  ga('send', 'pageview');

</script>

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Book",
  "url": "http://www.testcookbook.com",
  "name": "Test Cookbook",
  "author": "Ben Harrington",
  "bookFormat": {
  	"@type": "BookFormatType",
  	"name": "Test Cookbook",
    "url": "http://www.testcookbook.com"
  }
}
</script>

  </head>

  <body>
    <div class="w3-container w3-blue">
      <div class="titleHeader">
        <span class="w3-opennav w3-hide-large w3-hide-medium" onclick="w3_open()">
          <i class="fa fa-book" aria-hidden="true"></i>
        </span>
        <!--<span class="w3-opennav w3-hide-large w3-hide-medium" onclick="w3_open()">&#9776;</span>-->
        <a class="w3-btn w3-blue" href="/">
          <i class="fa fa-book w3-hide-small" aria-hidden="true"></i>
          Test Cookbook</a>
      </div>
    </div>
    <div class="w3-row">
      <div class="w3-col m4 l3 w3-green">
        <nav class="w3-sidebar w3-collapse" id="mySidenav">
          <a href="#" onclick="w3_close()" class="w3-btn w3-closenav w3-hide-large w3-hide-medium">Close &times;</a>
          <a href="/news.html">News</a>
<a href="/index.html">Introduction</a>
<a href="/book/programming/bash">Bash</a>
<a href="/book/programming/clojure">Clojure</a>
<a href="/book/programming/java">Java</a>
<a href="/book/programming/javascript">Javascript</a>
<a href="/book/programming/php">PHP</a>
<a href="/book/programming/python">Python</a>
<a href="/book/programming/ruby">Ruby</a>
<a href="/book/glossary/glossary.html">Glossary</a>
<a href="https://docs.google.com/forms/d/e/1FAIpQLSeGwJ-QoKN_QLvGL5VEWP2YJdnRSTuGV3J3JovR42mdEYAndw/viewform">Feedback</a>

        </nav>
      </div>
      <div class="w3-col m8 l9">
        <div class="w3-container">
          <h1 id="validating-json-with-python">Validating JSON with Python</h1>

<p>JSON or Javascript object notation works quite well in Python.  There are 2
possible attributes that we need to look at to tell whether or not the JSON is
in a proper format.  The first is making sure all the quotes, brackets and
commas are in the right place.  The second is validating that result to a JSON
schema.</p>

<h2 id="validate-basic-json-syntax">Validate basic JSON syntax</h2>

<header class="cm1 w3-blue">
  <!--<img alt="file icon image" src="/lib/images/file.png" class="icon"/>-->
<i class="fa fa-file-code-o" aria-hidden="true"></i>

  test.py
</header>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">validate_json_syntax</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'DEBUG: JSON data contains an error'</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="c">#will return the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="s">'{"firstName": "John", "lastName": "Doe"}'</span>
<span class="k">print</span> <span class="n">validate_json_syntax</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c">#will return false because JSON not valid</span>
<span class="c">#missing quotes around lastName</span>
<span class="n">data</span> <span class="o">=</span> <span class="s">'{"firstName": "John", lastName: "Doe"}'</span>
<span class="k">print</span> <span class="n">validate_json_syntax</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre>
</div>

<p>Run the test to see what output looks like.</p>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code>$ python test.py
{u'lastName': u'Doe', u'firstName': u'John'}
DEBUG: JSON data contains an error
False
</code></pre>
</div>

<p>Once we have loaded the JSON and we know that it is syntactically correct. We
can now start testing the JSON schema. Lets load up that test.py again and add
JSON schema.</p>

<header class="cm1 w3-blue">
  <!--<img alt="file icon image" src="/lib/images/file.png" class="icon"/>-->
<i class="fa fa-file-code-o" aria-hidden="true"></i>

  test.py
</header>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">jsonschema</span> <span class="kn">import</span> <span class="n">validate</span>

<span class="k">def</span> <span class="nf">validate_json_syntax</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'DEBUG: JSON data contains an error'</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="n">data</span> <span class="o">=</span> <span class="s">'{"firstName": "John", "lastName": "Doe"}'</span>
<span class="n">jsd</span> <span class="o">=</span> <span class="n">validate_json_syntax</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"type"</span><span class="p">:</span> <span class="s">"object"</span><span class="p">,</span>
    <span class="s">"properties"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"firstName"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"type"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">},</span>
      <span class="s">"lastName"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"type"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c">#output will be None</span>
<span class="k">print</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">jsd</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>

</code></pre>
</div>

<p>This just happens to be a happy path example for a JSON schema validation.  But
what if for some reason we really wanted the lastName to be a number? Within
the schema change type to number.  Then run the program and see what happens.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"type"</span><span class="p">:</span> <span class="s">"object"</span><span class="p">,</span>
    <span class="s">"properties"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"firstName"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"type"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">},</span>
      <span class="s">"lastName"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"type"</span><span class="p">:</span> <span class="s">"number"</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You should have some output that looks like.</p>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code>$ python test.py
jsonschema.exceptions.ValidationError: u'Doe' is not of type 'number'

Failed validating 'type' in schema['properties']['lastName']:
    {'type': 'number'}

On instance['lastName']:
    u'Doe'
</code></pre>
</div>


        </div>
      </div>
    </div>
    <script>
function w3_open() {
  document.getElementById("mySidenav").style.display = "block";
}
function w3_close() {
  document.getElementById("mySidenav").style.display = "none";
}
function myAccFunc(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
        x.previousElementSibling.className += " w3-green";
    } else {
        x.className = x.className.replace(" w3-show", "");
        x.previousElementSibling.className =
        x.previousElementSibling.className.replace(" w3-green", "");
    }
}
    </script>
  </body>
</html>
