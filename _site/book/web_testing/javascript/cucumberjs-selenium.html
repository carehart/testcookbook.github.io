<!DOCTYPE html>
<html>
  <head>
    <title>CucumberJS and Selenium</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="content-language" content="en-us">
    <meta name="description" content="Cucumber testing suite using Javascript and Selenium Web Driver">
    <link rel="stylesheet" href="/lib/w3.css" />
    <link rel="stylesheet" href="/lib/style.css" />
    <link rel="stylesheet" href="/lib/zenburn.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85156207-1', 'auto');
  ga('send', 'pageview');

</script>

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Book",
  "url": "http://www.testcookbook.com",
  "name": "Test Cookbook",
  "author": "Ben Harrington",
  "bookFormat": {
  	"@type": "BookFormatType",
  	"name": "Test Cookbook",
    "url": "http://www.testcookbook.com"
  }
}
</script>

  </head>

  <body>
    <div class="w3-container w3-blue">
      <div class="titleHeader">
        <span class="w3-opennav w3-hide-large w3-hide-medium" onclick="w3_open()">
          <i class="fa fa-book" aria-hidden="true"></i>
        </span>
        <!--<span class="w3-opennav w3-hide-large w3-hide-medium" onclick="w3_open()">&#9776;</span>-->
        <a class="w3-btn w3-blue" href="/">
          <i class="fa fa-book w3-hide-small" aria-hidden="true"></i>
          Test Cookbook</a>
      </div>
    </div>
    <div class="w3-row">
      <div class="w3-col m4 l3 w3-green">
        <nav class="w3-sidebar w3-collapse" id="mySidenav">
          <a href="#" onclick="w3_close()" class="w3-btn w3-closenav w3-hide-large w3-hide-medium">Close &times;</a>
          <a href="/news.html">News</a>
<a href="/index.html">Introduction</a>
<a href="/book/programming/bash">Bash</a>
<a href="/book/programming/c">C</a>
<a href="/book/programming/clojure">Clojure</a>
<a href="/book/programming/java">Java</a>
<a href="/book/programming/javascript">Javascript</a>
<a href="/book/programming/php">PHP</a>
<a href="/book/programming/python">Python</a>
<a href="/book/programming/ruby">Ruby</a>
<a href="/book/glossary/glossary.html">Glossary</a>
<a href="https://docs.google.com/forms/d/e/1FAIpQLSeGwJ-QoKN_QLvGL5VEWP2YJdnRSTuGV3J3JovR42mdEYAndw/viewform">Feedback</a>

        </nav>
      </div>
      <div class="w3-col m8 l9">
        <div class="w3-container">
          <h1 id="cucumberjs--selenium-web-driver">CucumberJS + Selenium Web Driver</h1>

<h2 id="create-a-cucumberjs-project">Create a CucumberJS project</h2>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code># install Cucumber and Selenium webdriver
$ npm install cucumber selenium-webdriver

# install browser drivers
$ npm install chromedriver geckodriver

# install an assertion tool
$ npm install assert
</code></pre>
</div>

<p>If you are using a package.json file you will probably want to save all of these
modules to dev dependencies.  to do that when running npm install add a switch
–save-dev to the command.</p>

<div class="w3-panel w3-pale-yellow w3-bottombar w3-topbar w3-border-green">
<i class="fa fa-lightbulb-o" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/tip100.png" class="icon"/>-->

  Another nice thing to do with a package.json file is to add test script.
</div>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"test"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./node_modules/.bin/cucumber-js"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>With this added to your NPM package file you can run all your cucumber tests by
typing in “npm test” on the command line.</p>

<hr />

<h2 id="folder-structure">Folder Structure</h2>

<p>First off we need to create a place for all of our feature files written in
Gherkin.  Within this folder you will create files with an extension of feature.
For example “testFile.feature”.</p>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code>mkdir features
</code></pre>
</div>

<p>After creating the features directory we need a place to store our code that
runs the features and does the assertions.  We call these step definitions.</p>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code>cd features
mkdir step_definitions
</code></pre>
</div>

<p>Last but not least we need to create a support directory that handles
initializing the World object for Cucumber and other enhancements for Cucumber.</p>

<header class="cm1 w3-grey">
  <i class="fa fa-terminal" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/cli.png" class="icon"/>-->

  Command Line
</header>

<div class="highlighter-rouge"><pre class="highlight"><code>mkdir support
</code></pre>
</div>

<p>Once done you should have a folder stucture like this.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- features
  - step_definitions
  - support
</code></pre>
</div>

<hr />

<h2 id="create-the-cucumber-world">Create the Cucumber World.</h2>

<p>Within the support directory create a file named “world.js”.  In this file we
can require some libraries, select browser to test with and set some timeouts.</p>

<header class="cm1 w3-blue">
  <!--<img alt="file icon image" src="/lib/images/file.png" class="icon"/>-->
<i class="fa fa-file-code-o" aria-hidden="true"></i>

  world.js
</header>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">seleniumWebdriver</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'selenium-webdriver'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">CustomWorld</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">driver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">seleniumWebdriver</span><span class="p">.</span><span class="nx">Builder</span><span class="p">()</span>
                  <span class="p">.</span><span class="nx">forBrowser</span><span class="p">(</span><span class="s1">'firefox'</span><span class="p">)</span>
                  <span class="p">.</span><span class="nx">build</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">World</span> <span class="o">=</span> <span class="nx">CustomWorld</span><span class="p">;</span>

  <span class="c1">// sets a default timeout to 30 seconds.  Time is in ms.</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setDefaultTimeout</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<hr />

<h2 id="describe-your-behavior">Describe your behavior.</h2>

<p>Create a feature file like “test_cookbook.feature”.  Within the file describe
the behavior that you would like.</p>

<header class="cm1 w3-blue">
  <!--<img alt="file icon image" src="/lib/images/file.png" class="icon"/>-->
<i class="fa fa-file-code-o" aria-hidden="true"></i>

  testCookbook.feature
</header>
<div class="language-gherkin highlighter-rouge"><pre class="highlight"><code><span class="kd">Feature</span><span class="p">:</span> Test Cookbook Home Page

  <span class="kn">Scenario</span><span class="p">:</span> Test Cookbook Title Description
    <span class="nf">Given</span> I visit Test Cookbook website
    <span class="nf">Then</span> I see title Test Cookbook
</code></pre>
</div>

<hr />

<h2 id="define-your-step">Define your step.</h2>

<p>Create a file called “test_cookbook.js” and we can start building our step
definitions.</p>

<p>Within the file we first need to setup a javascript module.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>
</code></pre>
</div>

<p>When you run the tests Cucumber will be looking for regular expression  matching
functions to execute. In the feature file the first step we have is a Given
statement.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Now that we have an expression to run, we also need to give it some direction.
Lets have it take us to “www.testcookbook.com”.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>If you were to run the tests at this point you should see a browser pop up and
goto “www.testcookbook.com”.</p>

<div class="w3-panel w3-pale-yellow w3-bottombar w3-topbar w3-border-green">
<i class="fa fa-lightbulb-o" aria-hidden="true"></i>
<!--<img alt="tip image" src="/lib/images/tip100.png" class="icon"/>-->

At this point you may still see a browser on the screen.  While starting out its
not a big deal to close the window by hand.  However we can add a hooks.js file
within the step_definitions folder to handle that for us.
</div>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>We now have some code in place to take us to a website.  But thats not really
testing anything.  If we look back at the feature file we have a validation
step that says the title of the page should be “Test Cookbook”.  To accomplish
this we need to get the text for the title and assert whether or not it equals
the desired outcome.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">Then</span><span class="p">(</span><span class="sr">/^I see title Test Cookbook$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="s2">"Test Cookbook"</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">title</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Now give it a run.</p>

<p>UH OH!!  It didn’t work like expected did it? You probably see something that
says “ReferenceError: assert is not defined”. CucumberJS needs an extra library
in order to assert or expect specific values.  Luckily this is an easy fix.
Provided that you installed the assert package at the beginning all we need to
do is require assert.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'assert'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Given</span><span class="p">(</span><span class="sr">/^I visit Test Cookbook website$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'http://www.testcookbook.com'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">Then</span><span class="p">(</span><span class="sr">/^I see title Test Cookbook$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">driver</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="s2">"Test Cookbook"</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">title</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div>

<p>If you run npm test this time you should be able to get some passing tests.</p>

<p>Please note if you are working with Firefox that newer versions will require
geckodriver.  If you see firefox open up and never does anything you are
more than likely missing that module.</p>

<p>Would you like to pull down a working project?  Look on GitHub.<br />
<a href="https://github.com/testcookbook/js-cucumber-selenium">https://github.com/testcookbook/js-cucumber-selenium</a></p>

        </div>
      </div>
    </div>
    <script>
function w3_open() {
  document.getElementById("mySidenav").style.display = "block";
}
function w3_close() {
  document.getElementById("mySidenav").style.display = "none";
}
function myAccFunc(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
        x.previousElementSibling.className += " w3-green";
    } else {
        x.className = x.className.replace(" w3-show", "");
        x.previousElementSibling.className =
        x.previousElementSibling.className.replace(" w3-green", "");
    }
}
    </script>
    <center>
    <footer class="w3-container">Join us on IRC at <a href="http://webchat.freenode.net/?channels=testcookbook">#testcookbook</a> on freenode.</footer>
</center>
  </body>
</html>
